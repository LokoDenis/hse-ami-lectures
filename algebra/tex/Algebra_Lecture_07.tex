\documentclass[a4paper,10pt]{amsart}

\usepackage[T2A]{fontenc}
\usepackage[cp1251]{inputenc}
\usepackage{amssymb}
\usepackage[russian]{babel}
\usepackage{geometry}
\usepackage{hyperref}
\usepackage{enumitem}

\geometry{a4paper,top=2cm,bottom=2cm,left=2cm,right=2cm}

\setlength{\parindent}{0pt}
\setlength{\parskip}{\medskipamount}

\newcommand{\Ker}{\mathop{\mathrm{Ker}}}
\renewcommand{\Im}{\mathop{\mathrm{Im}}}
\DeclareMathOperator{\Tor}{\mathrm{Tor}}
%\newcommand{\Tor}{\mathop{\mathrm{Tor}}}

%\def\Ker{{\rm Ker}}%
%\def\Im{{\rm Im}}%
\def\Mat{{\rm Mat}}%
\def\cont{{\rm cont}}%
%\def\Tor{{\rm Tor}}%
\def\Char{{\rm Char}}%
\def\signum{{\rm sig}}%
\def\Sym{{\rm Sym}}%
\def\St{{\rm St}}%
\def\Aut{{\rm Aut}}%
\def\Chi{{\mathbb X}}%
\def\Tau{{\rm T}}%
\def\Rho{{\rm R}}%
\def\rk{{\rm rk}}%
\def\ggT{{\rm ggT}}%
\def\kgV{{\rm kgV}}%
\def\Div{{\rm Div}}%
\def\div{{\rm div}}%
\def\quot{/\!\!/}%
\def\mal{\! \cdot \!}%
\def\Of{{\mathcal{O}}}
%
\def\subgrpneq{\le}%
\def\subgrp{\le}%
\def\ideal#1{\le_{#1}}%
\def\submod#1{\le_{#1}}%
%
\def\Bild{{\rm Bild}}%
\def\Kern{{\rm Kern}}%
\def\bangle#1{{\langle #1 \rangle}}%
\def\rq#1{\widehat{#1}}%
\def\t#1{\widetilde{#1}}%
\def\b#1{\overline{#1}}%
%
\def\abs#1{{\vert #1 \vert}}%
\def\norm#1#2{{\Vert #1 \Vert}_{#2}}%
\def\PS#1#2{{\sum_{\nu=0}^{\infty} #1_{\nu} #2^{\nu}}}%
%
\def\C{{\rm C}}%
\def\O{{\rm O}}%
\def\HH{{\mathbb H}}%
\def\LL{{\mathbb L}}%
\def\FF{{\mathbb F}}%
\def\CC{{\mathbb C}}%
\def\KK{{\mathbb K}}%
\def\TT{{\mathbb T}}%
\def\ZZ{{\mathbb Z}}%
\def\RR{{\mathbb R}}%
\def\SS{{\mathbb S}}%
\def\NN{{\mathbb N}}%
\def\QQ{{\mathbb Q}}%
\def\PP{{\mathbb P}}%
\def\AA{{\mathbb A}}%
%
\def\eins{{\mathbf 1}}%
%
\def\AG{{\rm AG}}%
\def\Aut{{\rm Aut}}%
\def\Hol{{\rm Hol}}%
\def\GL{{\rm GL}}%
\def\SL{{\rm SL}}%
\def\SO{{\rm SO}}%
\def\Sp{{\rm Sp}}%
\def\gl{\mathfrak{gl}}%
\def\rg{{\rm rg}}%
\def\sl{\mathfrak{sl}}%
\def\HDiv{{\rm HDiv}}%
\def\CDiv{{\rm CDiv}}%
\def\Res{{\rm Res}}%
\def\Pst{{\rm Pst}}%
\def\Nst{{\rm Nst}}%
\def\rad{{\rm rad}}%
\def\GL{{\rm GL}}%
\def\Tr{{\rm Tr}}%
\def\Pic{{\rm Pic}}%
\def\Hom{{\rm Hom}}%
\def\hom{{\rm hom}}%
\def\Mor{{\rm Mor}}%
\def\codim{{\rm codim}}%
\def\Supp{{\rm Supp}}%
\def\Spec{{\rm Spec}}%
\def\Proj{{\rm Proj}}%
\def\Maps{{\rm Maps}}%
\def\cone{{\rm cone}}%
\def\ord{{\rm ord}}%
\def\pr{{\rm pr}}%
\def\id{{\rm id}}%
\def\mult{{\rm mult}}%
\def\inv{{\rm inv}}%
\def\neut{{\rm neut}}%
%
\def\AAA{\mathcal{A}}
\def\BBB{\mathcal{B}}
\def\CCC{\mathcal{C}}
\def\EEE{\mathcal{E}}
\def\FFF{\mathcal{F}}

\def\CF{{\rm CF}}
\def\GCD{{\rm GCD}}
\def\Mat{{\rm Mat}}
\def\End{{\rm End}}
\def\cont{{\rm cont}}
\def\Kegel{{\rm Kegel}}
\def\Char{{\rm Char}}
\def\Der{{\rm Der}}
\def\signum{{\rm sg}}
\def\grad{{\rm grad}}
\def\Spur{{\rm Spur}}
\def\Sym{{\rm Sym}}
\def\Alt{{\rm Alt}}
\def\Abb{{\rm Abb}}
\def\Chi{{\mathbb X}}
\def\Tau{{\rm T}}
\def\Rho{{\rm R}}
\def\ad{{\rm ad}}
\def\Frob{{\rm Frob}}
\def\Rang{{\rm Rang}}
\def\SpRang{{\rm SpRang}}
\def\ZRang{{\rm ZRang}}
\def\ggT{{\rm ggT}}
\def\kgV{{\rm kgV}}
\def\Div{{\rm Div}}
\def\div{{\rm div}}
\def\quot{/\!\!/}
\def\mal{\! \cdot \!}
\def\add{{\rm add}}
\def\mult{{\rm mult}}
\def\smult{{\rm smult}}

\def\subgrpneq{\le}
\def\subgrp{\le}
\def\ideal#1{\unlhd_{#1}}
\def\submod#1{\le_{#1}}

\def\Bild{{\rm Bild}}
\def\Kern{{\rm Kern}}
\def\Kon{{\rm Kon}}
\def\bangle#1{{\langle #1 \rangle}}
\def\rq#1{\widehat{#1}}
\def\t#1{\widetilde{#1}}
\def\b#1{\overline{#1}}

\def\abs#1{{\vert #1 \vert}}
\def\norm#1#2{{\Vert #1 \Vert}_{#2}}
\def\PS#1#2{{\sum_{\nu=0}^{\infty} #1_{\nu} #2^{\nu}}}


\def\eins{{\mathbf 1}}

\def\ElM{{\rm ElM}}
\def\ZOp{{\rm ZOp}}
\def\SpOp{{\rm SpOp}}
\def\Gal{{\rm Gal}}
\def\Def{{\rm Def}}
\def\Fix{{\rm Fix}}
\def\ord{{\rm ord}}
\def\Aut{{\rm Aut}}
\def\Hol{{\rm Hol}}
\def\GL{{\rm GL}}
\def\SL{{\rm SL}}
\def\SO{{\rm SO}}
\def\Sp{{\rm Sp}}
\def\Spann{{\rm Spann}}
\def\Lin{{\rm Lin}}
\def\gl{\mathfrak{gl}}
\def\rg{{\rm rg}}
\def\sl{\mathfrak{sl}}
\def\so{\mathfrak{so}}
\def\sp{\mathfrak{sp}}
\def\gg{\mathfrak{g}}
\def\HDiv{{\rm HDiv}}
\def\CDiv{{\rm CDiv}}
\def\Res{{\rm Res}}
\def\Pst{{\rm Pst}}
\def\Nst{{\rm Nst}}
\def\WDiv{{\rm WDiv}}
\def\GL{{\rm GL}}
\def\Tr{{\rm Tr}}
\def\Pic{{\rm Pic}}
\def\Hom{{\rm Hom}}
\def\hom{{\rm hom}}
\def\Mor{{\rm Mor}}
\def\codim{{\rm codim}}
\def\Supp{{\rm Supp}}
\def\Spec{{\rm Spec}}
\def\Proj{{\rm Proj}}
\def\Maps{{\rm Maps}}
\def\cone{{\rm cone}}
\def\ord{{\rm ord}}
\def\pr{{\rm pr}}
\def\id{{\rm id}}
\def\mult{{\rm mult}}
\def\inv{{\rm inv}}
\def\neut{{\rm neut}}
\def\trdeg{{\rm trdeg}}
\def\sing{{\rm sing}}
\def\reg{{\rm reg}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newtheorem{theorem}{Теорема}
\newtheorem{proposition}{Предложение}
\newtheorem{lemma}{Лемма}
\newtheorem{corollary}{Следствие}
\theoremstyle{definition}
\newtheorem{definition}{Определение}
\newtheorem{problem}{Задача}
%
\theoremstyle{remark}
\newtheorem{exercise}{Упражнение}
\newtheorem{remark}{Замечание}
\newtheorem{example}{Пример}

\renewcommand{\theenumi}{\textup{(\alph{enumi})}}
\renewcommand{\labelenumi}{\theenumi}
\newcounter{property}
\renewcommand{\theproperty}{\textup{(\arabic{property})}}
\newcommand{\property}{\refstepcounter{property}\item}
\newcounter{prooperty}
\renewcommand{\theprooperty}{\textup{(\arabic{prooperty})}}
\newcommand{\prooperty}{\refstepcounter{prooperty}\item}

\makeatletter
\def\keywords#1{{\def\@thefnmark{\relax}\@footnotetext{#1}}}
\let\subjclass\keywords
\makeatother
%
\begin{document}
%
\sloppy
%\thispagestyle{empty}
%
\centerline{\large \bf Лекции курса \guillemotleft
Алгебра\guillemotright{}, лекторы И.\,В.~Аржанцев и Р.\,С.~Авдеев}

\smallskip

\centerline{\large ФКН НИУ ВШЭ, 1-й курс ОП ПМИ, 4-й модуль,
2014/2015 учебный год}


\bigskip

\section*{Лекция~7}

\medskip

{\it Евклидовы кольца, кольца главных идеалов и факториальные
кольца. Факториальность кольца многочленов от многих переменных.}

\medskip

В этой лекции всюду предполагается, что $R$~--- коммутативное кольцо
без делителей нуля.

\begin{definition}
Говорят, что элемент $b \in R$ {\it делит} элемент $a\in R$ ($b$~---
\textit{делитель}~$a$, $a$ \textit{делится} на~$b$; пишут $b \,|\,
a$) если существует элемент $c\in R$, для которого $a=bc$.
\end{definition}

\begin{definition}
Два элемента $a, b \in R$ называются {\it ассоциированными}, если
$a=bc$ для некоторого обратимого элемента $c$ кольца~$R$.
\end{definition}

\begin{remark}
Легко видеть, что отношение ассоциированности является отношением
эквивалентности на кольце~$R$.
\end{remark}

\begin{definition}
Кольцо $R$ без делителей нуля, не являющееся полем, называется {\it
евклидовым}, если существует функция
$$
N\colon R\setminus\{0\} \to \ZZ_{\geqslant 0}
$$
(называемая {\it нормой}), удовлетворяющая следующим условиям:

1) $N(ab) \geqslant N(a)$ для всех $a, b \in R \setminus \{0\}$;

2) для любых $a, b \in R$, $b \ne 0$, существуют такие $q,r\in R$,
что $a = qb + r$ и либо $r = 0$, либо $N(r) < N(b)$.
\end{definition}

Неформально говоря, условие 2) означает возможность \guillemotleft
деления с остатком\guillemotright{} в кольце~$R$.

\textbf{Примеры евклидовых колец:}

1) $\ZZ$ с нормой $N(a) = |a|$;

2) $K[x]$ (где $K$~--- произвольное поле) с нормой $N(f) = \deg f$.

\begin{lemma} \label{lemma_first}
Пусть $R$~--- евклидово кольцо и $a,b \in R \setminus \lbrace 0
\rbrace$. Равенство $N(ab) = N(a)$ выполнено тогда и только тогда,
когда $b$ обратим.
\end{lemma}

\begin{proof}
Если $b$ обратим, то $N(a)\leqslant N(ab)\leqslant
N(abb^{-1})=N(a)$, откуда $N(ab)=N(a)$.

Пусть теперь $N(ab) = N(a)$. Разделим $a$ на $ab$ с остатком: $a =
qab + r$, где либо $r = 0$, либо $N(r) < N(ab)$. Если $r \ne 0$, то
с учётом равенства $r = a(1-qb)$ имеем $N(a) \leqslant N(a(1-qb)) =
N(r) < N(ab) = N(a)$~--- противоречие. Значит, $r = 0$ и $a = qab$,
откуда $a(1 - qb) = 0$. Так как в $R$ нет делителей нуля и $a \ne
0$, то $1 - qb = 0$, откуда $qb = 1$, т.\,е. $b$ обратим.
\end{proof}

\begin{definition}
{\it Наибольшим общим делителем} элементов $a$ и $b$ кольца $R$
называется их общий делитель, который делится на любой другой их
общий делитель. Он обозначается $(a,b)$.
\end{definition}

\begin{remark}
Если наибольший общий делитель двух элементов $a,b \in R$
существует, то он определён однозначно с точностью до
ассоциированности, т.\,е. умножения на обратимый элемент кольца~$R$.
\end{remark}

\begin{theorem} \label{thm_lcd}
Пусть $R$~--- евклидово кольцо и $a,b$~--- произвольные элементы.
Тогда:

\textup{(1)} существует наибольший общий делитель $(a,b)$;

\textup{(2)} существуют такие элементы $u,v \in R$, что $(a,b) = ua
+ vb$.
\end{theorem}

\begin{proof}
В основе доказательства лежит следующее простое наблюдение:
множество общих делителей элементов $a,b \in R$ совпадает с
множеством общих делителей элементов $a - qb$ и $b$, где $q \in
R$~--- произвольный элемент. Отсюда вытекает, что $(a,b) = (b, a -
qb)$.

Теперь доказательство утверждения (1) получается применением
(прямого хода) алгоритма Евклида, а~утверждения~(2)~--- применением
обратного хода в алгоритме Евклида.
\end{proof}

\begin{definition}
Кольцо $R$ называется \textit{кольцом главных идеалов}, если всякий
идеал в $R$ является главным.
\end{definition}

\begin{theorem} \label{thm_er_rpi}
Всякое евклидово кольцо $R$ является кольцом главных идеалов.
\end{theorem}

\begin{proof}
Пусть $I$~--- произвольный идеал в~$R$. Если $I = \lbrace 0
\rbrace$, то $I = (0)$ и поэтому $I$ является главным. Далее
считаем, что $I \ne \lbrace 0 \rbrace$. Пусть $a \in I \setminus
\lbrace 0 \rbrace$~--- элемент с наименьшей нормой. Тогда главный
идеал $(a)$ содержится в~$I$. Предположим, что какой-то элемент $b
\in I$ не лежит в~$(a)$, т.\,е. не делится на~$a$. Тогда разделим
$b$ на $a$ с остатком: $b = qa + r$, где $r \ne 0$ и $N(r) < N(a)$.
Так как $r = b - aq$, то $r \in I$, что в силу неравенства $N(r) <
N(a)$ противоречит нашему выбору элемента~$a$.
\end{proof}

\begin{definition}
Ненулевой необратимый элемент $p$ кольца $R$ называется {\it
простым}, если он не может быть представлен в виде $p = a b$, где
$a, b \in R$~--- необратимые элементы.
\end{definition}

\begin{remark}
Простые элементы в кольце многочленов $K[x]$ над полем $K$ принято
называть {\it неприводимыми многочленами}.
\end{remark}

\begin{lemma} \label{ll}
Если простой элемент $p$ евклидова кольца $R$ делит произведение
$a_1a_2\ldots a_n$, то он делит один из сомножителей.
\end{lemma}

\begin{proof}
Индукция по~$n$. Пусть $n=2$ и предположим, что $p$ не делит~$a_1$.
Тогда $(p, a_1) = 1$ и по утверждению~(2) теоремы~\ref{thm_lcd}
найдутся такие элементы $u, v \in R$, что $1 = up + v a_1$. Умножая
обе части этого равенства на~$a_2$, получаем
$$
a_2 = upa_2 + v a_1a_2.
$$
Легко видеть, что $p$ делит правую часть последнего равенства,
поэтому $p$ делит и левую часть, т.\,е.~$a_2$.

При $n > 2$ применяем предыдущее рассуждение к $(a_1 \ldots
a_{n-1})a_n$ и пользуемся предположением индукции.
\end{proof}

\begin{definition}
Кольцо $R$ называется {\it факториальным}, если всякий его ненулевой
необратимый элемент \guillemotleft разложим на простые
множители\guillemotright{}, т.\,е. представим в виде произведения
(конечного числа) простых элементов, причём это представление
единственно с точностью до перестановки множителей и
ассоциированности.
\end{definition}

Более формально единственность разложения на простые множители
следует понимать так: если для элемента $a \in R$ есть два
представления
$$
a = p_1 p_2 \ldots p_n = q_1q_2 \ldots q_m,
$$
где все элементы $p_i, q_j$ простые, то $n = m$ и существует такая
подстановка $\sigma \in S_n$, что для каждого $i = 1,\ldots, n$
элементы $p_i$ и $q_{\sigma(i)}$ ассоциированы.

\begin{theorem} \label{thm_er_ufd}
Всякое евклидово кольцо $R$ является факториальным.
\end{theorem}

\begin{proof}[Доказательство \textup{состоит из двух шагов.}]~

\textit{Шаг}~1. Сначала докажем, что всякий ненулевой необратимый
элемент из $R$ разложим на простые множители. Предположим, что это
не так, и среди всех элементов, не разложимых на простые множители,
выберем элемент $a$ с наименьшей нормой. Тогда $a$ не может быть
простым (иначе он разложим в произведение, состоящее из одного
простого множителя), поэтому существует представление вида $a = bc$,
где $b,c \in R$~--- ненулевые необратимые элементы. Но тогда в силу
леммы~\ref{lemma_first} имеем $N(b) < N(a)$ и $N(c) < N(a)$, поэтому
элементы $b$ и $c$ разложимы на простые множители. Но тогда и $a$
разложим~--- противоречие.

\textit{Шаг}~2. Докажем теперь индукцией по~$n$, что если для
некоторого элемента $a \in R$ имеются два разложения
$$
a = p_1p_2\ldots p_n=q_1q_2\ldots q_m,
$$
где все элемнты $p_i$ и $q_j$ простые, то $m=n$ и после подходящей
перенумерации элементов $q_j$ окажется, что при всех $i = 1,\ldots,
n$ элемент $p_i$ ассоциирован с~$q_i$.

Если $n=1$, то $a = p_1$; тогда из определения простого элемента
следует, что $m = 1$ и тем самым $q_1 = p_1$. Пусть теперь $n > 1$.
Тогда элемент $p_1$ делит произведение $q_1 q_2 \ldots q_m$. По
лемме~\ref{ll} этот элемент делит некоторый~$q_i$, а значит,
ассоциирован с ним. Выполнив перенумерацию, можно считать, что $i =
1$ и $q_1 = cp_1$ для некоторого обратимого элемента $c \in R$. Так
как в $R$ нет делителей нуля, то мы можем сократить на~$p_1$, после
чего получится равенство
$$
p_2 p_3 \ldots p_n = (cq_2)q_3 \ldots q_m
$$
(заметьте, что элемент $cq_2$ прост!). Дальше используем
предположение индукции.
\end{proof}

Можно показать (см. листок с задачами к лекции~6), что при $n
\geqslant 2$ кольцо многочленов $K[x_1, \ldots, x_n]$ над
произвольным полем~$K$ не является кольцом главных идеалов, а
значит, по теореме~\ref{thm_er_rpi} это кольцо не является
евклидовым. Тем не менее, наша цель в оставшейся части этой
лекции~--- доказать, что кольцо $K[x_1, \ldots, x_n]$ факториально.

Начнём издалека. С~каждым (коммутативным) кольцом $R$ (без делителей
нуля) связано его \textit{поле отношений}~$K$. Элементами этого поля
являются дроби вида $\frac{a}{b}$, где $a,b \in R$ и $b\ne 0$, со
стандартными правилами отождествления ($\frac{a}{b} = \frac{c}{d}
\Leftrightarrow ad = bc$), сложения ($\frac{a}{b} + \frac{c}{d} =
\frac{ad+bc}{bd}$) и умножения ($\frac{a}{b}\frac{c}{d} =
\frac{ac}{bd}$). Кольцо $R$ реализуется как подкольцо в~$K$,
состоящее из всех дробей вида $\frac{a}{1}$.

\textbf{Модельный пример:} $\QQ$ есть поле отношений кольца~$\ZZ$.

Всякий гомоморфизм колец $\varphi \colon R \to R'$ индуцирует
гомоморфизм $\widetilde \varphi \colon R[x] \to R'[x]$
соответствующих колец многочленов, задаваемый по правилу
$$
a_n x^n + a_{n-1} x^{n-1} + \ldots a_1 x + a_0 \mapsto \varphi(a_n)
x^n + \varphi(a_{n-1}) x^{n-1} + \ldots \varphi(a_1) x +
\varphi(a_0).
$$
Вспомнив, как определяется умножение в кольце многочленов, легко
показать, что $\widetilde \varphi$ действительно является
гомоморфизмом.

В~частности, если $R$~--- кольцо и $K$~--- его поле частных, то
вложение $R \hookrightarrow K$ индуцирует вложение $R[x]
\hookrightarrow K[x]$, так что всякий многочлен с коэффициентами из
$R$ можно рассматривать как многочлен с коэффициентами из~$K$.

Пусть $R$~--- кольцо.

\begin{definition}
Многочлен $f(x)\in R[x]$ называется {\it примитивным}, если в $R$
нет необратимого элемента, который делит все коэффициенты многочлена
$f(x)$.
\end{definition}

{\bf Лемма Гаусса.}\ Если $R$~--- факториальное кольцо c полем
отношений $K$ и многочлен $f(x) \in R[x]$ разлагается в произведение
двух многочленов в кольце $K[x]$, то он разлагается в произведение
двух пропорциональных им многочленов в кольце~$R[x]$.

В доказательстве леммы Гаусса нам потребуются следующие факты.

\begin{exercise} \label{ex_1}
Пусть $R$~--- факториальное кольцо и $p \in R$~--- простой элемент.
Тогда в факторкольце $R/(p)$ нет делителей нуля.
\end{exercise}

\begin{exercise} \label{ex_2}
Пусть $R$~--- (коммутативное) кольцо (без делителей нуля). Тогда в
кольце многочленов $R[x]$ также нет делителей нуля.
\end{exercise}

\begin{proof}[Доказательство леммы Гаусса]
Пусть $f(x) = g(x)h(x)$, где $g(x), h(x)\in K[x]$. Так как кольцо
$R$ факториально, то для любого набора элементов из $R$ определены
наибольший общий делитель и наименьшее общее кратное. С~учётом этого
приведём все коэффициенты многочлена $g(x)$ к общему знаменателю,
после чего вынесем за скобку этот общий знаменатель и наибольший
общий делитель всех числителей. В результате в скобках останется
примитивный многочлен $g_1(x) \in R[x]$, а за скобками~--- некоторый
элемент из поля~$K$. Аналогичным образом найдём примитивный
многочлен $h_1(x) \in R[x]$, который пропорционален
многочлену~$h(x)$. Теперь мы можем записать $f(x)=\frac{u}{v}g_1(x)
h_1(x)$, где $u,v \in R$, $v \ne 0$ и без ограничения общности можно
считать $(u,v)=1$. Для завершения доказательства достаточно
показать, что элемент $v$ обратим (и тогда разложение $f(x) =
(uv^{-1}g_1(x))h_1(x)$ будет искомым).

Предположим, что $v$ необратим. Тогда найдётся простой элемент $p
\in R$, который делит~$v$. Рассмотрим гомоморфизм факторизации
$\varphi \colon R \to R/(p)$, $a \mapsto a + (p)$, и соответствующий
ему гомоморфизм колец многочленов $\widetilde \varphi \colon R[x]
\to (R/(p))[x]$. В кольце $R[x]$ у нас имеется равенство $vf(x) =
ug_1(x)h_1(x)$. Взяв образ обеих частей этого равенства при
гомоморфизме $\widetilde \varphi$, мы получим следующее равенство в
кольце $(R / (p))[x]$:
\begin{equation} \label{eqn}
\widetilde \varphi(v) \widetilde \varphi(f(x)) = \widetilde
\varphi(u) \widetilde \varphi(g_1(x)) \widetilde \varphi(h_1(x)).
\end{equation}
Поскольку $p$ делит~$v$, имеем $\widetilde \varphi(v) = 0$, поэтому
левая часть равенства~(\ref{eqn}) равна нулю. С другой стороны, из
условия $(u,v) = 1$ следует, что $\widetilde \varphi(u) \ne 0$, а из
примитивности многочленов $g_1(x)$ и $h_1(x)$ вытекает, что
$\widetilde \varphi(g_1(x)) \ne 0$ и $\widetilde \varphi(h_1(x)) \ne
0$. Таким образом, все три множителя в правой части
равенства~(\ref{eqn}) отличны от нуля. Из упражнений~\ref{ex_1}
и~\ref{ex_2} вытекает, что в кольце $(R / (p))[x]$ нет делителей
нуля, поэтому правая часть равенства~(\ref{eqn}) отлична от нуля, и
мы пришли к противоречию.
\end{proof}

\begin{corollary} \label{cc}
Если многочлен $f(x)\in R[x]$ может быть разложен в произведение
двух многочленов меньшей степени в кольце $K[x]$, то он может быть
разложен и в произведение двух многочленов меньшей степени в кольце
$R[x]$.
\end{corollary}

\begin{theorem}
Если кольцо $R$ факториально, то кольцо многочленов $R[x]$ также
факториально.
\end{theorem}

\begin{proof}
Следствие~\ref{cc} показывает, что простые элементы кольца
$R[x]$~--- это в точности элементы одного из следующих двух типов:

1) простые элементы кольца $R$ (рассматриваемые как многочлены
степени~$0$ в $R[x]$);

2) примитивные многочлены из $R[x]$, неприводимые над полем
отношений~$K$.

Ясно, что каждый многочлен из $R[x]$ разлагается в произведение
таких многочленов. Предположим, что какой-то элемент из $R[x]$ двумя
способами представим в виде такого произведения:
$$
a_1 \ldots a_n b_1(x) \ldots b_m(x) = a'_1 \ldots a'_k b'_1(x)
\ldots b'_l(x),
$$
где $a_i, a'_j$~--- простые элементы типа~1 и $b_i(x), b'_j(x)$~---
простые элементы типа~2.

Рассмотрим эти разложения в кольце $K[x]$. Как мы уже знаем из
теоремы~\ref{thm_er_ufd}, кольцо $K[x]$ факториально. Отсюда
следует, что $m = l$ и после подходящей перенумерации элементов
$b'_j(x)$ получается, что при всех $j = 1, \ldots, m$ элементы
$b_j(x)$ и $b'_j(x)$ ассоциированы в $K[x]$, а в силу примитивности
они ассоциированы и в $R[x]$. После сокращения всех таких элементов
у нас останутся два разложения на простые множители (какого-то)
элемента из~$R$. Но кольцо $R$ факториально, поэтому эти два
разложения совпадают с точностью до перестановки множителей и
ассоциированности.
\end{proof}

\begin{theorem}
Пусть $K$~--- произвольное поле. Тогда кольцо многочленов
$K[x_1,\ldots,x_n]$ факториально.
\end{theorem}

\begin{proof}
Воспользуемся индукцией по~$n$. При $n=1$ наше кольцо евклидово и по
теореме~\ref{thm_er_ufd} факториально. При $n > 1$ имеем $K[x_1,
\ldots, x_n] = K[x_1, \ldots, x_{n-1}][x_n]$, кольцо $K[x_1, \ldots,
x_{n-1}]$ факториально по предположению индукции и требуемый
результат следует из предыдущей теоремы.
\end{proof}

\begin{remark}
Несмотря на естественность условия единственности разложения на
простые множители, большинство колец не являются факториальными.
Например, таковым не является кольцо $\ZZ[\sqrt{-5}]$, состоящее из
всех комплексных чисел вида $a + b \sqrt{-5}$, где $a,b \in \ZZ$: в
этом кольце число $6$ разлагается на простые множители двумя
различными способами: $6 = 2 \cdot 3 = (1 + \sqrt{-5})(1 -
\sqrt{-5})$.
\end{remark}

\bigskip

\begin{thebibliography}{99}
\bibitem{Vi}
Э.\,Б.~Винберг. Курс алгебры. М.: Факториал Пресс, 2002 (глава~3,
\S\,5, 10 и глава~9, \S\,5)
\bibitem{Ko1}
А.\,И.~Кострикин. Введение в алгебру. Основы алгебры. М.: Наука.
Физматлит, 1994 (глава~5, \S\,2,3,4)
\bibitem{Ko3}
А.\,И.~Кострикин. Введение в алгебру. Основные структуры алгебры.
М.: Наука. Физматлит, 2000 (глава~4, \S\,2)
\bibitem{SZ}
Сборник задач по алгебре под редакцией А.\,И.~Кострикина. Новое
издание. М.: МЦНМО, 2009 (глава 14, \S\,63--64)
\end{thebibliography}


\end{document}
