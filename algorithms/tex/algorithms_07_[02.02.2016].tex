\input{header.tex}

\begin{document}

\section*{Лекция 5 от 26.01.2016}

\subsection{Умножение чисел}

Запишем умножение столбиком. На получение одной строки нужно $O(n)$ операций, на сложение --- тоже $O(n)$; итого --- $O(n^2)$. Можно ли быстрее? Колмогоров считал нельзя, оказалось, что можно.

Воспользуемся стратегией ``Разделяй и властвуй''. 

\begin{align*}
    x &= 10^{\frac{n}{2}}a + b\\
    y &= 10^{\frac{n}{2}}c + d\\
    \hline
    xy &= 10^nac + 10^{\frac{n}{2}}(ad+bc)+bd
\end{align*}

$T(n) = 4T\left( \frac{n}{2} \right) + \Theta(n)$

$T(n) \leqslant aT\left( \frac{n}{b} \right) + n^d$

$a = 4;\ b = 2;\ d = 1$

$a > b^d$

$T(n) = O\left( n^{\log_ba} \right) = O(a^2)$

А если сведём к трем подзадачам? Тогда получится вот так:

$T(n) = O\left( n^{\log_23} \right) \approx O(n^{1.58})$

Давайте перемножим:

$(a+b)(c+d) = ac+(ad+bc) + bd$

То есть $ad+bc$ из формулы --- это $(a+b)(c+d) - ac - bd$

$xy = 10^nac + 10^{\frac{n}{2}}z+bd$

И получили \emph{алгоритм Карацубы}.

\subsection{Перемножение матриц}

Пусть у нас есть квадратные матрицы $A = (a_{ij})$ и $B = (b_{ij})$. Пусть $C = A\times B$. Действуя строго по определению, умножение матриц займёт $O(n^3)$ --- для каждого жлемента матрицы нужно $n$ умножений и $n-1$ сложение, а элементов всего --- $n^2$.

И снова --- ``Разделяй и властвуй''. Попробуем делить матрицы на четыре подматрицы. Тогда пусть $A = \begin{pmatrix}
    A_{11}&A_{12}\\
    A_{21}&A_{22}
\end{pmatrix}$, 
$B = \begin{pmatrix}
    B_{11}&B_{12}\\
    B_{21}&B_{22}
\end{pmatrix}$.
Тогда $C = A\times B =
\begin{pmatrix}
    A_{11}B_{11}+A_{12}B_{21}&\ldots\\
    \vdots&\ddots
\end{pmatrix}$.

$T(n) = 8T\left( \frac{n}{2} \right) + O(n^2)$

Основная теорема: $8 > 2^2$

$O\left( n^{\log_28} \right) = O(n^2)$.

А если свести к семи подзадачам?

Алгоритм довольно простой, но как до него додуматься --- не вполне понятно.

\begin{align*}
    M_1 &= (A_{11} + A_{22})(B_{11}+B_{22}); \\
    M_2 &= (A_{21} + A_{22})B_{11}; \\
    M_3 &= A_{11}(B_{12}-B_{22}); \\
    M_4 &= A_{22}(B_{21}+B_{11}); \\
    M_5 &= (A_{11} + A_{12})B_{22}; \\
    M_6 &= (A_{21} - A_{11})(B_{11}+B_{12}); \\
    M_7 &= (A_{12} - A_{22})(B_{21}+B_{22}); \\
\end{align*}

\begin{align*}
    C_1 &= M_1+M_4-M_5+M_7; \\
    C_2 &= M_3+M_5; \\
    C_3 &= M_2+M_4; \\
    C_4 &= M_1-M_2+M_5+M_6; \\
\end{align*}

Можно проверить что всё верно (оставим это как упражнение читателю).

$T(n) = 7T\left( \frac{n}{2} \right) + O(n^2)$

$O\left( n^{\log_27} \right)$
\end{document}
